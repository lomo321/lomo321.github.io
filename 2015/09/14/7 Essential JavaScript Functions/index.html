<!doctype html>
<html>
   <head>
    <meta charset="utf-8">
    <title>lomo's blog</title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?a33121bb6751d4a4716c741475e1f9e5";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    <link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
<div id="container">
    <div id="sideBar">
    <h1>
        <span class="line-left"></span>
        <div class="brand">
            <span class="line-top"></span>
            <a class="logo" href="/">Lomo's Blog</a>
            <span class="line-bottom"></span>
        </div>
        <span class="line-right"></span>
    </h1>
    <ul class="menu">
        <li class="menu-item"><a href="/" class="menu-link">Home</a></li>
        <li class="menu-item"><a href="/archives" class="menu-link">Archive</a></li>
        <li class="menu-item"><a class="menu-link" style="text-decoration:line-through;">Photo</a></li>
        <li class="menu-item"><a class="menu-link" style="text-decoration:line-through;">About Me</a></li>
    </ul>
</div>
    <div id="main">
        <nav id="mobile-nav">
        <h1>
            <span class="line-left"></span>
            <div class="brand">
                <span class="line-top"></span>
                <a class="logo" href="/">Lomo's Blog</a>
                <span class="line-bottom"></span>
            </div>
            <span class="line-right"></span>
        </h1>
        <ul class="menu2">
            <li class="menu-item2"><a href="/" class="menu-link">Home</a></li>
            <li class="menu-item2"><a href="/archives" class="menu-link">Archive</a></li>
            <li class="menu-item2"><a class="menu-link" style="text-decoration:line-through;">Photo</a></li>
            <li class="menu-item2"><a class="menu-link" style="text-decoration:line-through;">About Me</a></li>
        </ul>
        <div id="topBar">
            <!--<div class="toolBar"></div>-->
            <h1 id="title"> Lomo's Blog</h1>
        </div>
</nav>
        <div id="content">


    
<article class="article">
    <header class="article-title" id="article-title-7 Essential JavaScript Functions">
        
        <h1>7 Essential JavaScript Functions</h1>
        
        <h5 class="date">2015/09/14</h5>

        <div class="line"></div>
    </header>
    
    <div class="article-entry"><p>看到同事<code>天空男-斯盖勒</code>的博客中<a href="http://www.skylerzhang.com/js/2015/06/14/7-Essential-JavaScript-Functions/" target="_blank" rel="external">《七个必备的js函数》</a>这篇文章，满怀希望地点进去了。毫无意外地感到了失望，他只翻译了一个函数。作为好同事的我，决定把剩下的六个也翻译了</p>
<p>原文链接<a href="http://davidwalsh.name/essential-javascript-functions" target="_blank" rel="external">7 Essential JavaScript Functions</a></p>
<h1 id="debounce(去抖)">debounce(去抖)</h1><hr>
<p>什么是<code>debounce</code>？<br>举个例子，设置一个时间t毫秒，在触发事件后的t毫秒内，假如事件没有再次被触发，则执行回调函数；若再次触发，则重新计时。</p>
<p><code>debouce</code>函数是提升事件驱动性能方面的佼佼者。如果没有把去抖函数使用在<code>scroll</code>,<code>resize</code>,<code>key</code>等事件中，你的程序可能会出现错误。下面这个debounce函数 可以使你的代码更加高效：</p>
<a id="more"></a>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> debounce(func, <span class="built_in">wait</span>, immediate) &#123;</span><br><span class="line">	var timeout;</span><br><span class="line">	<span class="built_in">return</span> <span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">		var context = this, args = arguments;</span><br><span class="line">		var later = <span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">			timeout = null;</span><br><span class="line">			<span class="keyword">if</span> (!immediate) func.apply(context, args);</span><br><span class="line">		&#125;;</span><br><span class="line">		var callNow = immediate &amp;&amp; !timeout;</span><br><span class="line">		clearTimeout(timeout);</span><br><span class="line">		timeout = <span class="built_in">set</span>Timeout(later, <span class="built_in">wait</span>);</span><br><span class="line">		<span class="keyword">if</span> (callNow) func.apply(context, args);</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;;</span><br><span class="line">var myEfficientFn = debounce(<span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">	//your code</span><br><span class="line">&#125;, <span class="number">250</span>);</span><br><span class="line">window.addEventListener(<span class="string">'resize'</span>, myEfficientFn);</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="throttle">throttle</h1><hr>
<p>最后补充一个节流函数。在使用<code>mousemove</code>，<code>resize</code>或者<code>scroll</code>这类事件的时候，事件会不断地被触发，回调函数多次被执行。而<code>throttle</code>函数可以控制执行频率。这里给一个简单的实现方式（详细见<a href="http://www.cnblogs.com/fsjohnhuang/p/4147810.html" target="_blank" rel="external">throttle与debounce</a>）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> throttle = <span class="function"><span class="keyword">function</span>(<span class="params">delay, action</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> last = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> curr = +<span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    <span class="keyword">if</span> (curr - last &gt; delay)</span><br><span class="line">      action.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    last = curr;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="poll">poll</h1><hr>
<p>使用上文提到的去抖函数，有时候你并不能为你所需的某个状态触发一个回调（譬如你希望某个div元素宽度达到100px时触发一个回调），因为这个事件有可能不存在。这时你需要每隔一段时间就检测一次状态，看看是否满足条件触发回调。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">poll</span>(<span class="params">fn, callback, errback, timeout, interval</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> endTime = <span class="built_in">Number</span>(<span class="keyword">new</span> <span class="built_in">Date</span>()) + (timeout || <span class="number">2000</span>);</span><br><span class="line">    interval = interval || <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    (<span class="function"><span class="keyword">function</span> <span class="title">p</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// 如果条件满足</span></span><br><span class="line">            <span class="keyword">if</span>(fn()) &#123;</span><br><span class="line">                callback();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 假如不满足，设置间隔时间</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">Number</span>(<span class="keyword">new</span> <span class="built_in">Date</span>()) &lt; endTime) &#123;</span><br><span class="line">                setTimeout(p, interval);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 超时则报错</span></span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                errback(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'timed out for '</span> + fn + <span class="string">': '</span> + <span class="built_in">arguments</span>));</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;)();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Usage:  ensure element is visible</span></span><br><span class="line">poll(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(<span class="string">'lightbox'</span>).offsetWidth &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Done, success callback</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Error, failure callback</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="once">once</h1><hr>
<p>很多情况下，你希望函数只能执行一次，类似你使用<code>`onload</code>事件的方式。以下的代码实现了这个功能。</p>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">function once(fn, context) &#123;</span><br><span class="line">	<span class="keyword">var</span> <span class="literal">result</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> function() &#123;</span><br><span class="line">		<span class="keyword">if</span>(fn) &#123;</span><br><span class="line">			<span class="literal">result</span> = fn.apply(context || this, arguments);</span><br><span class="line">			fn = null;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">result</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// <span class="type">Usage</span></span><br><span class="line"><span class="keyword">var</span> canOnlyFireOnce = once(function() &#123;</span><br><span class="line">	console.log('<span class="type">Fired</span>!');</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">canOnlyFireOnce(); // <span class="string">"Fired!"</span></span><br><span class="line">canOnlyFireOnce(); // nada</span><br></pre></td></tr></table></figure>
<p><code>once</code>确保了函数只执行一次，从而可以避免重复初始化。</p>
<hr>
<h1 id="getAbsoluteUrl">getAbsoluteUrl</h1><hr>
<p>这是一个获取绝对地址的小技巧：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> getAbsoluteUrl = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> a;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(!a) a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</span><br><span class="line">		a.href = url;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> a.href;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="comment">// Usage</span></span><br><span class="line">getAbsoluteUrl(<span class="string">'/something'</span>); <span class="comment">// http://davidwalsh.name/something</span></span><br></pre></td></tr></table></figure>
<hr>
<h1 id="isNative">isNative</h1><hr>
<p>有时候你声明的函数名可能跟原生的函数名重复了，那如何才能知道一个函数是否为原生的。这段简单的代码可以给你答案：</p>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">;(function() &#123;</span><br><span class="line"></span><br><span class="line">  // <span class="type">Used</span> to resolve the internal `[[<span class="type">Class</span>]]` <span class="keyword">of</span> values</span><br><span class="line">  <span class="keyword">var</span> toString = <span class="type">Object</span>.prototype.toString;</span><br><span class="line"></span><br><span class="line">  // <span class="type">Used</span> to resolve the decompiled source <span class="keyword">of</span> functions</span><br><span class="line">  <span class="keyword">var</span> fnToString = <span class="type">Function</span>.prototype.toString;</span><br><span class="line"></span><br><span class="line">  // <span class="type">Used</span> to detect host constructors (<span class="type">Safari</span> &gt; <span class="number">4</span>; really typed <span class="type">array</span> specific)</span><br><span class="line">  <span class="keyword">var</span> reHostCtor = /^\[<span class="keyword">object</span> .+?<span class="type">Constructor</span>\]$/;</span><br><span class="line"></span><br><span class="line">  // <span class="type">Compile</span> a regexp <span class="keyword">using</span> a common native <span class="keyword">method</span> <span class="keyword">as</span> a <span class="keyword">template</span>.</span><br><span class="line">  // <span class="type">We</span> chose `<span class="type">Object</span><span class="comment">#toString` because there's a good chance it is not being mucked with.</span></span><br><span class="line">  <span class="keyword">var</span> reNative = <span class="type">RegExp</span>('^' +</span><br><span class="line">    // <span class="type">Coerce</span> `<span class="type">Object</span><span class="comment">#toString` to a string</span></span><br><span class="line">    <span class="type">String</span>(toString)</span><br><span class="line">    // <span class="type">Escape</span> <span class="type">any</span> special regexp characters</span><br><span class="line">    .replace(/[.*+?^$&#123;&#125;()|[\]\/\\]/g, '\\$&amp;')</span><br><span class="line">    // <span class="type">Replace</span> mentions <span class="keyword">of</span> `toString` <span class="keyword">with</span> `.*?` to keep the <span class="keyword">template</span> <span class="keyword">generic</span>.</span><br><span class="line">    // <span class="type">Replace</span> thing like `<span class="keyword">for</span> ...` to support environments like <span class="type">Rhino</span> which add extra info</span><br><span class="line">    // such <span class="keyword">as</span> <span class="keyword">method</span> arity.</span><br><span class="line">    .replace(/toString|(function).*?(?=\\\()| <span class="keyword">for</span> .+?(?=\\\])/g, '$<span class="number">1</span>.*?') + '$'</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  function isNative(value) &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="keyword">type</span> = typeof value;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">type</span> == 'function'</span><br><span class="line">      // <span class="type">Use</span> `<span class="type">Function</span><span class="comment">#toString` to bypass the value's own `toString` method</span></span><br><span class="line">      // <span class="keyword">and</span> avoid being faked <span class="keyword">out</span>.</span><br><span class="line">      ? reNative.test(fnToString.call(value))</span><br><span class="line">      // <span class="type">Fallback</span> to a host <span class="keyword">object</span> check because some environments will represent</span><br><span class="line">      // things like typed arrays <span class="keyword">as</span> <span class="type">DOM</span> methods which may <span class="keyword">not</span> conform to the</span><br><span class="line">      // normal native pattern.</span><br><span class="line">      : (value &amp;&amp; <span class="keyword">type</span> == '<span class="keyword">object</span>' &amp;&amp; reHostCtor.test(toString.call(value))) || <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // <span class="keyword">export</span> however you want</span><br><span class="line">  module.exports = isNative;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line">// <span class="type">Usage</span></span><br><span class="line">isNative(alert); // <span class="literal">true</span></span><br><span class="line">isNative(myCustomFunction); // <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p>这段代码虽然不好看，但是很实用！</p>
<hr>
<h1 id="insertRule">insertRule</h1><hr>
<p>大家都知道我们可以从选择器中获取节点列表并且修改它们的样式，但我们有更高效的方法吗（像css一样）？</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">var sheet = <span class="list">(<span class="keyword">function</span><span class="list">()</span> &#123;</span><br><span class="line">	// Create the &lt;style&gt; tag</span><br><span class="line">	var style = document.createElement<span class="list">(<span class="quoted">'style</span>')</span><span class="comment">;</span></span><br><span class="line"></span><br><span class="line">	// Add a media <span class="list">(<span class="keyword">and/or</span> media query)</span> here if you<span class="quoted">'d</span> like!</span><br><span class="line">	// style.setAttribute<span class="list">(<span class="quoted">'media</span>', <span class="quoted">'screen</span>')</span></span><br><span class="line">	// style.setAttribute<span class="list">(<span class="quoted">'media</span>', <span class="quoted">'only</span> screen and <span class="list">(<span class="keyword">max-width</span> : <span class="number">1024</span>px)</span>')</span></span><br><span class="line"></span><br><span class="line">	// WebKit hack :<span class="list">(</span><br><span class="line">	<span class="keyword">style</span>.appendChild<span class="list">(<span class="keyword">document</span>.createTextNode<span class="list">('')</span>)</span><span class="comment">;</span></span><br><span class="line"></span><br><span class="line">	// Add the &lt;style&gt; element to the page</span><br><span class="line">	document.head.appendChild<span class="list">(<span class="keyword">style</span>)</span><span class="comment">;</span></span><br><span class="line"></span><br><span class="line">	return style.sheet<span class="comment">;</span></span><br><span class="line">&#125;)</span><span class="list">()</span><span class="comment">;</span></span><br><span class="line"></span><br><span class="line">// Usage</span><br><span class="line">sheet.insertRule<span class="list">(<span class="string">"header &#123; float: left; opacity: 0.8; &#125;"</span>, <span class="number">1</span>)</span><span class="comment">;</span></span></span><br></pre></td></tr></table></figure>
<hr>
<h1 id="matchesSelector">matchesSelector</h1><hr>
<p>讲解这个函数之前先补充一点相关知识：matchesSelector用来匹配dom元素是否匹配某css selector。<br>譬如</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="tag">div</span> id=<span class="string">"wraper"</span> class=<span class="string">"item"</span>&gt;&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    wraper.<span class="function"><span class="title">mozMatchesSelector</span><span class="params">(<span class="string">'div'</span>)</span></span> <span class="comment">// true 标签选择器</span></span><br><span class="line">    wraper.<span class="function"><span class="title">mozMatchesSelector</span><span class="params">(<span class="string">'#wraper'</span>)</span></span> <span class="comment">// true id选择器</span></span><br><span class="line">    wraper.<span class="function"><span class="title">mozMatchesSelector</span><span class="params">(<span class="string">'.item'</span>)</span></span> <span class="comment">// true 类选择器</span></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>目前除IE6-IE8，Firefox/Chrome/Safari/Opera/IE 的最新版本均已实现，但方法都带上了各自的前缀:</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Chrome/Safari</span>: <span class="string">webkitMatchesSelector</span></span><br><span class="line"><span class="attribute">FireFox</span>: <span class="string">mozMatchesSelector</span></span><br><span class="line"><span class="attribute">IE9+</span>: <span class="string">msMatchesSelector</span></span><br></pre></td></tr></table></figure>
<p>回到正题，<code>matchesSelector</code>解决了兼容性问题并提供了接口。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">matchesSelector</span>(<span class="params">el, selector</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> p = Element.prototype;</span><br><span class="line">	<span class="keyword">var</span> f = p.matches || p.webkitMatchesSelector || p.mozMatchesSelector || p.msMatchesSelector || <span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> [].indexOf.call(<span class="built_in">document</span>.querySelectorAll(s), <span class="keyword">this</span>) !== -<span class="number">1</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> f.call(el, selector);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Usage</span></span><br><span class="line">matchesSelector(<span class="built_in">document</span>.getElementById(<span class="string">'myDiv'</span>), <span class="string">'div.someSelector[some-attribute=true]'</span>)</span><br></pre></td></tr></table></figure>
<hr>
</div>
    <div class="article-more">
        <div class="line"></div>
        
        
        <a class="prev-next" href="/2015/09/10/hello-world/">下一篇：Hello World</a>
        
    </div>
    

    
    <div class="duoshuo">
        <!-- 多说评论框 start -->
        <div class="ds-thread" data-thread-key="article-title-7 Essential JavaScript Functions" data-title="7 Essential JavaScript Functions"
             data-url="http://lomo321.github.io/2015/09/14/7 Essential JavaScript Functions/"></div>
        <!-- 多说评论框 end -->
        <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
        <script type="text/javascript">
            var duoshuoQuery = {short_name: "lomo321"};
            (function () {
                var ds = document.createElement('script');
                ds.type = 'text/javascript';
                ds.async = true;
                ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
                ds.charset = 'UTF-8';
                (document.getElementsByTagName('head')[0]
                || document.getElementsByTagName('body')[0]).appendChild(ds);
            })();
        </script>
        <!-- 多说公共JS代码 end -->
    </div>
    

</article>




</div>
    </div>
</div>
    <script src="http://apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js"></script>
<!--<script src="/js/require.js" type="text/javascript"></script>-->
<script src="/js/com/velocity/velocity.min.js" type="text/javascript"></script>
<script src="/js/com/velocity/velocity.ui.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>
</body>

</html>